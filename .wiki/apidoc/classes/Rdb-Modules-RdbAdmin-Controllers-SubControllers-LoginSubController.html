<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Documentation</title>
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro">
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/template.css">
    <link rel="icon" href="../images/favicon.ico"/>
        <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.4.6/fuse.min.js"></script>
    <script src="../js/search.js"></script>
    <script defer src="../js/searchIndex.js"></script>
    </head>
<body>
<header class="phpdocumentor-top-header"></header>
<header class="phpdocumentor-header">
    <section class="phpdocumentor-section">
        <h1 class="phpdocumentor-title">Documentation</h1>
    </section>
</header>
<main class="phpdocumentor">
    <div class="phpdocumentor-section">
        <aside class="three phpdocumentor-columns phpdocumentor-sidebar">
    <section data-search-form class="phpdocumentor-search">
        <h1 class="phpdocumentor-sidebar__category-header">Search</h1>
        <label class="phpdocumentor-label">
            <span class="visually-hidden">Search for</span>
            <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
        </label>
    </section>

    
    <h1 class="phpdocumentor-sidebar__category-header">Namespaces</h1>
            <h2 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/default.html"><abbr title="\">Global</abbr></a></h2>
                    <h3 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/rdb.html"><abbr title="\Rdb">Rdb</abbr></a></h3>
            <ul class="phpdocumentor-list">
                                    <li><a href="../namespaces/rdb-modules.html"><abbr title="\Rdb\Modules">Modules</abbr></a></li>
                            </ul>
                    <h3 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/tests.html"><abbr title="\Tests">Tests</abbr></a></h3>
            <ul class="phpdocumentor-list">
                                    <li><a href="../namespaces/tests-rdb.html"><abbr title="\Tests\Rdb">Rdb</abbr></a></li>
                                    <li><a href="../namespaces/tests-rdbadmin.html"><abbr title="\Tests\RdbAdmin">RdbAdmin</abbr></a></li>
                            </ul>
            
        <h1 class="phpdocumentor-sidebar__category-header">Packages</h1>
            <h2 class="phpdocumentor-sidebar__root-package"><a href="../packages/Default.html"><abbr title="\Default">Default</abbr></a></h2>
        <ul class="phpdocumentor-list">
                    </ul>
            <h2 class="phpdocumentor-sidebar__root-package"><a href="../packages/RdbAdmin.html"><abbr title="\RdbAdmin">RdbAdmin</abbr></a></h2>
        <ul class="phpdocumentor-list">
                    </ul>
        
    <h1 class="phpdocumentor-sidebar__category-header">Reports</h1>
        <h2 class="phpdocumentor-sidebar__root-package"><a href="../reports/deprecated.html">Deprecated</a></h2>
    <h2 class="phpdocumentor-sidebar__root-package"><a href="../reports/errors.html">Errors</a></h2>
    <h2 class="phpdocumentor-sidebar__root-package"><a href="../reports/markers.html">Markers</a></h2>
</aside>

        <div class="nine phpdocumentor-columns phpdocumentor-content">
            <ul class="phpdocumentor-breadcrumbs">
    <li><a href="../index.html">Home</a></li>
                        <li><a href="../namespaces/rdb.html">Rdb</a></li>
                    <li><a href="../namespaces/rdb-modules.html">Modules</a></li>
                    <li><a href="../namespaces/rdb-modules-rdbadmin.html">RdbAdmin</a></li>
                    <li><a href="../namespaces/rdb-modules-rdbadmin-controllers.html">Controllers</a></li>
                    <li><a href="../namespaces/rdb-modules-rdbadmin-controllers-subcontrollers.html">_SubControllers</a></li>
            </ul>

    <article class="phpdocumentor-element phpdocumentor-class">
        <h2 class="phpdocumentor-content__title">
            LoginSubController
                            <span class="phpdocumentor-class__extends">
                    extends <abbr title="\Rdb\Modules\RdbAdmin\Controllers\BaseController">BaseController</abbr>
                </span>
                                        <div class="phpdocumentor-element__package">
                    in
                    <ul class="phpdocumentor-breadcrumbs">
                                                    <li><a href="../packages/Default.html">Default</a></li>
                                            </ul>
                </div>
                                                    <span class="phpdocumentor-class__extends">
                    Uses
                                            <a href="../classes/Rdb-Modules-RdbAdmin-Controllers-Admin-Users-Sessions-Traits-SessionsTrait.html"><abbr title="\Rdb\Modules\RdbAdmin\Controllers\Admin\Users\Sessions\Traits\SessionsTrait">SessionsTrait</abbr></a>,                                             <a href="../classes/Rdb-Modules-RdbAdmin-Controllers-Admin-Users-Traits-UsersTrait.html"><abbr title="\Rdb\Modules\RdbAdmin\Controllers\Admin\Users\Traits\UsersTrait">UsersTrait</abbr></a>                                    </span>
                    </h2>
        <aside class="phpdocumentor-element-found-in">
            <abbr class="phpdocumentor-element-found-in__file" title="Controllers/_SubControllers/LoginSubController.php"><a href="../files/controllers-subcontrollers-loginsubcontroller.html"><abbr title="Controllers/_SubControllers/LoginSubController.php">LoginSubController.php</abbr></a></abbr>
            :
            <span class="phpdocumentor-element-found-in__line">15</span>
        </aside>

        <p class="phpdocumentor-class__summary">Description of Login</p>
        <section class="phpdocumentor-class__description"></section>

        <h3>Table of Contents</h3>
        <table class="phpdocumentor-table_of_contents">
                                                                <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-Admin-Users-Sessions-Traits-SessionsTrait.html#property_totalLoggedInSessions">$totalLoggedInSessions</a></th>
                    <td class="phpdocumentor-cell"></td>
                    <td class="phpdocumentor-cell">int</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-Admin-Users-Sessions-Traits-SessionsTrait.html#property_userSessionCookieData">$userSessionCookieData</a></th>
                    <td class="phpdocumentor-cell"></td>
                    <td class="phpdocumentor-cell">array</td>
                </tr>
                                        <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-LoginSubController.html#method_doLogin2faClearData">doLogin2faClearData()</a></th>
                    <td class="phpdocumentor-cell">Clear 2 step verification code, time, temp data, cache, session (user_id).</td>
                    <td class="phpdocumentor-cell">mixed</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-LoginSubController.html#method_doLogin2faVerify">doLogin2faVerify()</a></th>
                    <td class="phpdocumentor-cell">Do verify 2 step verification login.</td>
                    <td class="phpdocumentor-cell">array</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-LoginSubController.html#method_doLoginFailedRecordLogins">doLoginFailedRecordLogins()</a></th>
                    <td class="phpdocumentor-cell">On check login failed, record logins (failed) if configuration was disabled brute-force prevention.</td>
                    <td class="phpdocumentor-cell">mixed</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-LoginSubController.html#method_doLoginFailedRegisterBruteForceFailedAuth">doLoginFailedRegisterBruteForceFailedAuth()</a></th>
                    <td class="phpdocumentor-cell">On check login failed, if brute-force attack prevention is enabled then it will be register the failed authentication.</td>
                    <td class="phpdocumentor-cell">mixed</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-LoginSubController.html#method_doLoginFailedSendLoginResetEmail">doLoginFailedSendLoginResetEmail()</a></th>
                    <td class="phpdocumentor-cell">On login failed, if uset status is disabled and contain word about simultaneous login locked or contain key in user_fields table then re-send the login with reset password link.</td>
                    <td class="phpdocumentor-cell">mixed</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-LoginSubController.html#method_doLoginFailedSetErrorMessage">doLoginFailedSetErrorMessage()</a></th>
                    <td class="phpdocumentor-cell">On check login failed, set the error message, set http response code (example: 4xx).</td>
                    <td class="phpdocumentor-cell">array</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-LoginSubController.html#method_doLoginSucceessRecordLogins">doLoginSucceessRecordLogins()</a></th>
                    <td class="phpdocumentor-cell">On check login success, record logins.</td>
                    <td class="phpdocumentor-cell">mixed</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-LoginSubController.html#method_doLoginSuccessSetCookie">doLoginSuccessSetCookie()</a></th>
                    <td class="phpdocumentor-cell">On check login success, set logged in cookie.</td>
                    <td class="phpdocumentor-cell">mixed</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-LoginSubController.html#method_doLoginSuccessUpdateLastLogin">doLoginSuccessUpdateLastLogin()</a></th>
                    <td class="phpdocumentor-cell">On check login success, update last login date/time.</td>
                    <td class="phpdocumentor-cell">mixed</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-LoginSubController.html#method_getCookieExpires">getCookieExpires()</a></th>
                    <td class="phpdocumentor-cell">Get cookie expires.</td>
                    <td class="phpdocumentor-cell">array</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-LoginSubController.html#method_handleLoginFail">handleLoginFail()</a></th>
                    <td class="phpdocumentor-cell">Handle login failed.</td>
                    <td class="phpdocumentor-cell">array</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-LoginSubController.html#method_handleLoginSuccess">handleLoginSuccess()</a></th>
                    <td class="phpdocumentor-cell">Handle login success.</td>
                    <td class="phpdocumentor-cell">array</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-LoginSubController.html#method_send2faCodeEmail">send2faCodeEmail()</a></th>
                    <td class="phpdocumentor-cell">Send 2 step verification code to email.</td>
                    <td class="phpdocumentor-cell">array</td>
                </tr>
                                                    <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-Admin-Users-Sessions-Traits-SessionsTrait.html#method_isUserLoggedIn">isUserLoggedIn()</a></th>
                    <td class="phpdocumentor-cell">Check if user is logged in.</td>
                    <td class="phpdocumentor-cell">bool</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-Admin-Users-Sessions-Traits-SessionsTrait.html#method_sessionTraitLogoutAll">sessionTraitLogoutAll()</a></th>
                    <td class="phpdocumentor-cell">Logout all succeeded login sessions, lock user account, send login link to user&#039;s email.</td>
                    <td class="phpdocumentor-cell">mixed</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-Admin-Users-Sessions-Traits-SessionsTrait.html#method_sessionTraitLogoutPreviousSessions">sessionTraitLogoutPreviousSessions()</a></th>
                    <td class="phpdocumentor-cell">Logout all sessions before latest succeeded login. (logout only succeeded login).</td>
                    <td class="phpdocumentor-cell">mixed</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-Admin-Users-Traits-UsersTrait.html#method_addUpdateUserFormValidation">addUpdateUserFormValidation()</a></th>
                    <td class="phpdocumentor-cell">Form validation for add and update user.</td>
                    <td class="phpdocumentor-cell">array</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-Admin-Users-Traits-UsersTrait.html#method_decryptUserFieldsKey">decryptUserFieldsKey()</a></th>
                    <td class="phpdocumentor-cell">Decrypt user fields key.</td>
                    <td class="phpdocumentor-cell">string</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-Admin-Users-Traits-UsersTrait.html#method_generateUserFieldsKey">generateUserFieldsKey()</a></th>
                    <td class="phpdocumentor-cell">Generate user fields key.</td>
                    <td class="phpdocumentor-cell">array</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-Admin-Users-Traits-UsersTrait.html#method_getUserUrlsMethods">getUserUrlsMethods()</a></th>
                    <td class="phpdocumentor-cell">Get URLs and methods about user pages.</td>
                    <td class="phpdocumentor-cell">array</td>
                </tr>
                            <tr>
                    <th class="phpdocumentor-heading"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-Admin-Users-Traits-UsersTrait.html#method_logoutUser">logoutUser()</a></th>
                    <td class="phpdocumentor-cell">Logout target user.</td>
                    <td class="phpdocumentor-cell">mixed</td>
                </tr>
                    </table>

        
                    <section>
                <h3 class="phpdocumentor-properties__header">Properties</h3>
                                                                    <a id="property_totalLoggedInSessions"></a>
<article
        class="
            phpdocumentor-property
            phpdocumentor-property--protected
                                "
>
    <h4 class="phpdocumentor-property__name">$totalLoggedInSessions</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/Admin/Users/Sessions/Traits/SessionsTrait.php"><a href="../files/controllers-admin-users-sessions-traits-sessionstrait.html"><abbr title="Controllers/Admin/Users/Sessions/Traits/SessionsTrait.php">SessionsTrait.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">22</span>
    </aside>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                <span class="phpdocumentor-signature__type">int</span>
        <span class="phpdocumentor-signature__name">$totalLoggedInSessions</span>
         = <span class="phpdocumentor-signature__default-value">""</span>    </code>
    </article>
                                    <a id="property_userSessionCookieData"></a>
<article
        class="
            phpdocumentor-property
            phpdocumentor-property--protected
                                "
>
    <h4 class="phpdocumentor-property__name">$userSessionCookieData</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/Admin/Users/Sessions/Traits/SessionsTrait.php"><a href="../files/controllers-admin-users-sessions-traits-sessionstrait.html"><abbr title="Controllers/Admin/Users/Sessions/Traits/SessionsTrait.php">SessionsTrait.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">28</span>
    </aside>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                <span class="phpdocumentor-signature__type">array</span>
        <span class="phpdocumentor-signature__name">$userSessionCookieData</span>
         = <span class="phpdocumentor-signature__default-value">[]</span>    </code>
    </article>
                            </section>
        
                    <section>
                <h3 class="phpdocumentor-methods__header">Methods</h3>
                                    <a id="method_doLogin2faClearData"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">doLogin2faClearData()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/_SubControllers/LoginSubController.php"><a href="../files/controllers-subcontrollers-loginsubcontroller.html"><abbr title="Controllers/_SubControllers/LoginSubController.php">LoginSubController.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">31</span>
    </aside>
        <p class="phpdocumentor-summary">Clear 2 step verification code, time, temp data, cache, session (user_id).</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">doLogin2faClearData</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$user_id</span> :
                <span class="phpdocumentor-signature__argument__return-type">int</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$UserFieldsDb</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserFieldsDb">UserFieldsDb</abbr></span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">mixed</span>
    </code>

    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$user_id</span>
                    : <span class="phpdocumentor-signature__argument__return-type">int</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The user ID.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$UserFieldsDb</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserFieldsDb">UserFieldsDb</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>UserFieldsDb model class.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">mixed</span>
            
</article>
                                    <a id="method_doLogin2faVerify"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--public
                                                        "
>
    <h4 class="phpdocumentor-method__name">doLogin2faVerify()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/_SubControllers/LoginSubController.php"><a href="../files/controllers-subcontrollers-loginsubcontroller.html"><abbr title="Controllers/_SubControllers/LoginSubController.php">LoginSubController.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">90</span>
    </aside>
        <p class="phpdocumentor-summary">Do verify 2 step verification login.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">public</span>
                                <span class="phpdocumentor-signature__name">doLogin2faVerify</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$user_id</span> :
                <span class="phpdocumentor-signature__argument__return-type">int</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$output</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$UserFieldsDb</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserFieldsDb">UserFieldsDb</abbr></span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$Url</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\System\Libraries\Url">Url</abbr></span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">array</span>
    </code>

        <section class="phpdocumentor-description"><p>If success:<br>
Clear code, time, temp data, session (user_id).<br>
Call to <code class="prettyprint">handleLoginSuccess()</code> method.<br>
If not request via ajax or rest api.<br>
Redirect to new url.<br>
Else.<br>
Return redirect url and login status result.<br>
If fail:<br>
If not over 3 times.<br>
It will be show http response code, error message, error form status.<br>
If over 3 times.<br>
If this request has not done via rest api or ajax then it will be redirect to new url if failed over x times.<br>
Clear code, time, temp data, session (user_id).</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$user_id</span>
                    : <span class="phpdocumentor-signature__argument__return-type">int</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$output</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$UserFieldsDb</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserFieldsDb">UserFieldsDb</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$Url</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\System\Libraries\Url">Url</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">array</span>
                    &mdash; <span class="phpdocumentor-description"><p>Return associative array with keys:<br>
'gobackUrl' (string - optional) Go back URL on success only.<br>
'redirectUrl' (string - optional) Redirect URL.<br>
'formResultStatus' (string - optional) Alert message status.<br>
'formResultMessage' (string, array) Alert messages.<br>
'submitTimes' (int) Number of submit failed.</p></span>
            
</article>
                                    <a id="method_doLoginFailedRecordLogins"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">doLoginFailedRecordLogins()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/_SubControllers/LoginSubController.php"><a href="../files/controllers-subcontrollers-loginsubcontroller.html"><abbr title="Controllers/_SubControllers/LoginSubController.php">LoginSubController.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">211</span>
    </aside>
        <p class="phpdocumentor-summary">On check login failed, record logins (failed) if configuration was disabled brute-force prevention.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">doLoginFailedRecordLogins</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$doLoginResult</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$output</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$untranslatedMessage</span> :
                <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$UserLoginsDb</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserLoginsDb">UserLoginsDb</abbr></span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">mixed</span>
    </code>

        <section class="phpdocumentor-description"><p>if configuration was enabled brute-force prevention via dc, it will be already record there in <code class="prettyprint">BruteForceLoginPrevention-&gt;registerFailedAuth()</code>.<br>
This method was called from <code class="prettyprint">handleLoginFail()</code> method.</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$doLoginResult</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The check login result that have got from <code class="prettyprint">\Rdb\Modules\RdbAdmin\Models\UsersDb-&gt;checkLogin()</code> method.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$output</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The output array that contain <code class="prettyprint">configDb</code> in key.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$untranslatedMessage</span>
                    : <span class="phpdocumentor-signature__argument__return-type">string</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The error message that was not translated.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$UserLoginsDb</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserLoginsDb">UserLoginsDb</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>UserLoginsDb model class.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">mixed</span>
            
</article>
                                    <a id="method_doLoginFailedRegisterBruteForceFailedAuth"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">doLoginFailedRegisterBruteForceFailedAuth()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/_SubControllers/LoginSubController.php"><a href="../files/controllers-subcontrollers-loginsubcontroller.html"><abbr title="Controllers/_SubControllers/LoginSubController.php">LoginSubController.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">245</span>
    </aside>
        <p class="phpdocumentor-summary">On check login failed, if brute-force attack prevention is enabled then it will be register the failed authentication.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">doLoginFailedRegisterBruteForceFailedAuth</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$doLoginResult</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$regFailedData</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$BruteForceLoginPrevention</span> :
                <span class="phpdocumentor-signature__argument__return-type"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-BruteForceLoginPrevention.html"><abbr title="\Rdb\Modules\RdbAdmin\Controllers\_SubControllers\BruteForceLoginPrevention">BruteForceLoginPrevention</abbr></a></span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">mixed</span>
    </code>

        <section class="phpdocumentor-description"><p>This method was called from <code class="prettyprint">handleLoginFail()</code> method.</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$doLoginResult</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The check login result that have got from <code class="prettyprint">\Rdb\Modules\RdbAdmin\Models\UsersDb-&gt;checkLogin()</code> method.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$regFailedData</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The register data. For more information please read in <code class="prettyprint">BruteForceLoginPrevention-&gt;registerFailedAuth()</code> method.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$BruteForceLoginPrevention</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-BruteForceLoginPrevention.html"><abbr title="\Rdb\Modules\RdbAdmin\Controllers\_SubControllers\BruteForceLoginPrevention">BruteForceLoginPrevention</abbr></a></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>BruteForceLoginPrevention class.</p></section></dd>
                    </dl>
    
                <h5 class="phpdocumentor-tag-list__heading">Tags</h5>
        <dl class="phpdocumentor-tag-list">
                                                <dt class="phpdocumentor-tag-list__entry">
                        <span class="phpdocumentor-tag__name">see</span>
                    </dt>
                    <dd class="phpdocumentor-tag-list__definition"><section class="phpdocumentor-description"></section></dd>
                                    </dl>
    
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">mixed</span>
            
</article>
                                    <a id="method_doLoginFailedSendLoginResetEmail"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">doLoginFailedSendLoginResetEmail()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/_SubControllers/LoginSubController.php"><a href="../files/controllers-subcontrollers-loginsubcontroller.html"><abbr title="Controllers/_SubControllers/LoginSubController.php">LoginSubController.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">273</span>
    </aside>
        <p class="phpdocumentor-summary">On login failed, if uset status is disabled and contain word about simultaneous login locked or contain key in user_fields table then re-send the login with reset password link.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">doLoginFailedSendLoginResetEmail</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$doLoginResult</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__reference-operator">&amp;</span><span class="phpdocumentor-signature__argument__name">$output</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$UserLoginsDb</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserLoginsDb">UserLoginsDb</abbr></span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">mixed</span>
    </code>

        <section class="phpdocumentor-description"><p>This will not check if password is correct or not (in case that users forgot their password so, the forgot password link will not working in this case).<br>
This method will set or add error message(s) and also set http response code (example: 4xx).<br>
This method was called from <code class="prettyprint">handleLoginFail()</code> method.</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$doLoginResult</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The check login result that have got from <code class="prettyprint">\Rdb\Modules\RdbAdmin\Models\UsersDb-&gt;checkLogin()</code> method.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$output</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The associative output used in <code class="prettyprint">doLogin()</code> method. This method will modify the output.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$UserLoginsDb</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserLoginsDb">UserLoginsDb</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>UserLoginsDb model class.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">mixed</span>
            
</article>
                                    <a id="method_doLoginFailedSetErrorMessage"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">doLoginFailedSetErrorMessage()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/_SubControllers/LoginSubController.php"><a href="../files/controllers-subcontrollers-loginsubcontroller.html"><abbr title="Controllers/_SubControllers/LoginSubController.php">LoginSubController.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">351</span>
    </aside>
        <p class="phpdocumentor-summary">On check login failed, set the error message, set http response code (example: 4xx).</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">doLoginFailedSetErrorMessage</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$doLoginResult</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$UsersDb</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UsersDb">UsersDb</abbr></span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">array</span>
    </code>

        <section class="phpdocumentor-description"><p>This method was called from <code class="prettyprint">handleLoginFail()</code> method.</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$doLoginResult</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The check login result that have got from <code class="prettyprint">\Rdb\Modules\RdbAdmin\Models\UsersDb-&gt;checkLogin()</code> method.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$UsersDb</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UsersDb">UsersDb</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>UsersDb model class.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">array</span>
                    &mdash; <span class="phpdocumentor-description"><p>Return associative array with keys:
<code class="prettyprint">formResultMessage</code> (string) The error message that was translated.<br>
<code class="prettyprint">untranslatedMessage</code> (string) The error message that was not translated.</p></span>
            
</article>
                                    <a id="method_doLoginSucceessRecordLogins"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">doLoginSucceessRecordLogins()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/_SubControllers/LoginSubController.php"><a href="../files/controllers-subcontrollers-loginsubcontroller.html"><abbr title="Controllers/_SubControllers/LoginSubController.php">LoginSubController.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">395</span>
    </aside>
        <p class="phpdocumentor-summary">On check login success, record logins.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">doLoginSucceessRecordLogins</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$doLoginResult</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$deviceCookieSignature</span> :
                <span class="phpdocumentor-signature__argument__return-type">string|null</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$UserLoginsDb</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserLoginsDb">UserLoginsDb</abbr></span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            [,                 <span class="phpdocumentor-signature__argument__name">$recordLoginsData</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                 = <span class="phpdocumentor-signature__argument__default-value">[]</span> ]            </span>
                )
        : <span class="phpdocumentor-signature__response_type">mixed</span>
    </code>

        <section class="phpdocumentor-description"><p>This method was called from <code class="prettyprint">handleLoginSuccess()</code> method.</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$doLoginResult</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The check login result that have got from <code class="prettyprint">\Rdb\Modules\RdbAdmin\Models\UsersDb-&gt;checkLogin()</code> method.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$deviceCookieSignature</span>
                    : <span class="phpdocumentor-signature__argument__return-type">string|null</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>Device cookie signature got from <code class="prettyprint">$BruteForceLoginPrevention-&gt;deviceCookieSignature</code> property.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$UserLoginsDb</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserLoginsDb">UserLoginsDb</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>UserLoginsDb model class.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$recordLoginsData</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                     = <span class="phpdocumentor-signature__argument__default-value">[]</span>                </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>Additional record logins data.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">mixed</span>
            
</article>
                                    <a id="method_doLoginSuccessSetCookie"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">doLoginSuccessSetCookie()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/_SubControllers/LoginSubController.php"><a href="../files/controllers-subcontrollers-loginsubcontroller.html"><abbr title="Controllers/_SubControllers/LoginSubController.php">LoginSubController.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">429</span>
    </aside>
        <p class="phpdocumentor-summary">On check login success, set logged in cookie.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">doLoginSuccessSetCookie</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$doLoginResult</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$cookieExpires</span> :
                <span class="phpdocumentor-signature__argument__return-type">int</span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">mixed</span>
    </code>

        <section class="phpdocumentor-description"><p>This method was called from <code class="prettyprint">handleLoginSuccess()</code> method.</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$doLoginResult</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The check login result that have got from <code class="prettyprint">\Rdb\Modules\RdbAdmin\Models\UsersDb-&gt;checkLogin()</code> method.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$cookieExpires</span>
                    : <span class="phpdocumentor-signature__argument__return-type">int</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The time the cookie expires. This is a Unix timestamp so is in number of seconds since the epoch. In other words, you'll most likely set this with the time() function plus the number of seconds before you want it to expire.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">mixed</span>
            
</article>
                                    <a id="method_doLoginSuccessUpdateLastLogin"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">doLoginSuccessUpdateLastLogin()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/_SubControllers/LoginSubController.php"><a href="../files/controllers-subcontrollers-loginsubcontroller.html"><abbr title="Controllers/_SubControllers/LoginSubController.php">LoginSubController.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">443</span>
    </aside>
        <p class="phpdocumentor-summary">On check login success, update last login date/time.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">doLoginSuccessUpdateLastLogin</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$doLoginResult</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">mixed</span>
    </code>

    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$doLoginResult</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The check login result that have got from <code class="prettyprint">\Rdb\Modules\RdbAdmin\Models\UsersDb-&gt;checkLogin()</code> method.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">mixed</span>
            
</article>
                                    <a id="method_getCookieExpires"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">getCookieExpires()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/_SubControllers/LoginSubController.php"><a href="../files/controllers-subcontrollers-loginsubcontroller.html"><abbr title="Controllers/_SubControllers/LoginSubController.php">LoginSubController.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">476</span>
    </aside>
        <p class="phpdocumentor-summary">Get cookie expires.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">getCookieExpires</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$data</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$output</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">array</span>
    </code>

        <section class="phpdocumentor-description"><p>This method was called from <code class="prettyprint">handleLoginSuccess()</code> method.</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$data</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The form data.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$output</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The output views data. Require array that contain keys:<br>
<code class="prettyprint">['configDb']['rdbadmin_UserLoginRememberLength']</code>,<br>
<code class="prettyprint">['configDb']['rdbadmin_UserLoginNotRememberLength']</code></p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">array</span>
                    &mdash; <span class="phpdocumentor-description"><p>Return associative array with keys:
<code class="prettyprint">expireDay</code> (int) expires in day,<br>
<code class="prettyprint">expireTimestamp</code> (int) expires in timestamp but it can be 0 (for session expires).</p></span>
            
</article>
                                    <a id="method_handleLoginFail"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--public
                                                        "
>
    <h4 class="phpdocumentor-method__name">handleLoginFail()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/_SubControllers/LoginSubController.php"><a href="../files/controllers-subcontrollers-loginsubcontroller.html"><abbr title="Controllers/_SubControllers/LoginSubController.php">LoginSubController.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">515</span>
    </aside>
        <p class="phpdocumentor-summary">Handle login failed.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">public</span>
                                <span class="phpdocumentor-signature__name">handleLoginFail</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$data</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$output</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$doLoginResult</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$UsersDb</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UsersDb">UsersDb</abbr></span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$UserLoginsDb</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserLoginsDb">UserLoginsDb</abbr></span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$BruteForceLoginPrevention</span> :
                <span class="phpdocumentor-signature__argument__return-type"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-BruteForceLoginPrevention.html"><abbr title="\Rdb\Modules\RdbAdmin\Controllers\_SubControllers\BruteForceLoginPrevention">BruteForceLoginPrevention</abbr></a></span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">array</span>
    </code>

        <section class="phpdocumentor-description"><p>Set error message, record failed logins, register brute-force failed auth.<br>
In case that account was locked because simultaneous login setting then re-send email.</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$data</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$output</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$doLoginResult</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$UsersDb</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UsersDb">UsersDb</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$UserLoginsDb</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserLoginsDb">UserLoginsDb</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$BruteForceLoginPrevention</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-BruteForceLoginPrevention.html"><abbr title="\Rdb\Modules\RdbAdmin\Controllers\_SubControllers\BruteForceLoginPrevention">BruteForceLoginPrevention</abbr></a></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">array</span>
            
</article>
                                    <a id="method_handleLoginSuccess"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--public
                                                        "
>
    <h4 class="phpdocumentor-method__name">handleLoginSuccess()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/_SubControllers/LoginSubController.php"><a href="../files/controllers-subcontrollers-loginsubcontroller.html"><abbr title="Controllers/_SubControllers/LoginSubController.php">LoginSubController.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">597</span>
    </aside>
        <p class="phpdocumentor-summary">Handle login success.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">public</span>
                                <span class="phpdocumentor-signature__name">handleLoginSuccess</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$data</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$output</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$doLoginResult</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$UserLoginsDb</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserLoginsDb">UserLoginsDb</abbr></span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$BruteForceLoginPrevention</span> :
                <span class="phpdocumentor-signature__argument__return-type"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-BruteForceLoginPrevention.html"><abbr title="\Rdb\Modules\RdbAdmin\Controllers\_SubControllers\BruteForceLoginPrevention">BruteForceLoginPrevention</abbr></a></span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">array</span>
    </code>

        <section class="phpdocumentor-description"><p>The processes in this method are:<br></p>
<ul>
<li>set session key to <code class="prettyprint">$doLoginResult['user']['sessionKey']</code> array.<br></li>
<li>update last login to users table.<br></li>
<li>set login cookie.<br></li>
<li>set new device cookie (for brute-force attack prevention).<br></li>
<li>delete brute-force locked-out.<br></li>
<li>record logins data (user agent, ip, session key, success status, etc).<br></li>
<li>set output success message and status.</li>
</ul></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$data</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The form data.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$output</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The output views data. Require array that contain keys:<br>
<code class="prettyprint">['configDb']['rdbadmin_UserLoginRememberLength']</code>,<br>
<code class="prettyprint">['configDb']['rdbadmin_UserLoginNotRememberLength']</code></p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$doLoginResult</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The check login result that have got from <code class="prettyprint">\Rdb\Modules\RdbAdmin\Models\UsersDb-&gt;checkLogin()</code> method.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$UserLoginsDb</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserLoginsDb">UserLoginsDb</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>UserLoginsDb model class.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$BruteForceLoginPrevention</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><a href="../classes/Rdb-Modules-RdbAdmin-Controllers-SubControllers-BruteForceLoginPrevention.html"><abbr title="\Rdb\Modules\RdbAdmin\Controllers\_SubControllers\BruteForceLoginPrevention">BruteForceLoginPrevention</abbr></a></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>BruteForceLoginPrevention class.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">array</span>
                    &mdash; <span class="phpdocumentor-description"><p>Return associative array with keys:<br>
'formResultStatus' (string) if there is alert message(s).<br>
'formResultMessage' (string) if there is alert message(s).<br>
'loggedIn' (bool) <code class="prettyprint">true</code> if login success, <code class="prettyprint">false</code> for otherwise.<br>
'loggedInData' (array) some user data.</p></span>
            
</article>
                                    <a id="method_send2faCodeEmail"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--public
                                                        "
>
    <h4 class="phpdocumentor-method__name">send2faCodeEmail()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/_SubControllers/LoginSubController.php"><a href="../files/controllers-subcontrollers-loginsubcontroller.html"><abbr title="Controllers/_SubControllers/LoginSubController.php">LoginSubController.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">686</span>
    </aside>
        <p class="phpdocumentor-summary">Send 2 step verification code to email.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">public</span>
                                <span class="phpdocumentor-signature__name">send2faCodeEmail</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$data</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$output</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$doLoginResult</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$UsersDb</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UsersDb">UsersDb</abbr></span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$UserFieldsDb</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserFieldsDb">UserFieldsDb</abbr></span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">array</span>
    </code>

        <section class="phpdocumentor-description"><p>This method will be set http response code if contains error.<br>
If send success, this method will be write temp data to db and set user id to session to use it later.</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$data</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The form data.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$output</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The output views data.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$doLoginResult</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The check login result that have got from <code class="prettyprint">\Rdb\Modules\RdbAdmin\Models\UsersDb-&gt;checkLogin()</code> method.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$UsersDb</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UsersDb">UsersDb</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>UsersDb model class.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$UserFieldsDb</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserFieldsDb">UserFieldsDb</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>UserFieldsDb model class.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">array</span>
                    &mdash; <span class="phpdocumentor-description"><p>Return associative array with the same <code class="prettyprint">$output</code> as in argument. Additional keys are:<br>
'formResultStatus' (string) if contain alert message(s).<br>
'formResultMessage' (array) if contain alert message(s).<br>
'emailSent' (bool) if sent successfully it will be <code class="prettyprint">true</code> otherwise will be <code class="prettyprint">false</code>.<br></p></span>
            
</article>
                                                                    <a id="method_isUserLoggedIn"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">isUserLoggedIn()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/Admin/Users/Sessions/Traits/SessionsTrait.php"><a href="../files/controllers-admin-users-sessions-traits-sessionstrait.html"><abbr title="Controllers/Admin/Users/Sessions/Traits/SessionsTrait.php">SessionsTrait.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">42</span>
    </aside>
        <p class="phpdocumentor-summary">Check if user is logged in.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">isUserLoggedIn</span>(
                    <span class="phpdocumentor-signature__argument">
            [                <span class="phpdocumentor-signature__argument__name">$user_id</span> :
                <span class="phpdocumentor-signature__argument__return-type">int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">null</span> ]            </span>
                    <span class="phpdocumentor-signature__argument">
            [,                 <span class="phpdocumentor-signature__argument__name">$userlogin_session_key</span> :
                <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span> ]            </span>
                )
        : <span class="phpdocumentor-signature__response_type">bool</span>
    </code>

        <section class="phpdocumentor-description"><p>After called this method and it was <code class="prettyprint">true</code> then you can access total sessions via <code class="prettyprint">totalLoggedInSessions</code> property.<br>
After called this method and cookie is valid then you can access cookie data via <code class="prettyprint">userSessionCookieData</code> property.<br>
If there is simultaneous login and user's setting is something that is not allowed (such as logout previous, logout all), it will be process here.</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$user_id</span>
                    : <span class="phpdocumentor-signature__argument__return-type">int</span>
                     = <span class="phpdocumentor-signature__argument__default-value">null</span>                </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The user ID. Set to <code class="prettyprint">null</code> (default) to auto detect from cookie.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$userlogin_session_key</span>
                    : <span class="phpdocumentor-signature__argument__return-type">string</span>
                     = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>                </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The logged in session key. Set to empty string (default) to auto detect from cookie.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">bool</span>
                    &mdash; <span class="phpdocumentor-description"><p>Return <code class="prettyprint">true</code> if logged in, <code class="prettyprint">false</code> for not.</p></span>
            
</article>
                                    <a id="method_sessionTraitLogoutAll"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">sessionTraitLogoutAll()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/Admin/Users/Sessions/Traits/SessionsTrait.php"><a href="../files/controllers-admin-users-sessions-traits-sessionstrait.html"><abbr title="Controllers/Admin/Users/Sessions/Traits/SessionsTrait.php">SessionsTrait.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">145</span>
    </aside>
        <p class="phpdocumentor-summary">Logout all succeeded login sessions, lock user account, send login link to user&#039;s email.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">sessionTraitLogoutAll</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$user_id</span> :
                <span class="phpdocumentor-signature__argument__return-type">int</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$UserLoginsDb</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserLoginsDb">UserLoginsDb</abbr></span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$UserFieldsDb</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserFieldsDb">UserFieldsDb</abbr></span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">mixed</span>
    </code>

        <section class="phpdocumentor-description"><p>This method also set cache that email was sent recently.<br>
This method was called from <code class="prettyprint">isUserLoggedIn()</code>.<br>
This method was called from <code class="prettyprint">LoginController-&gt;doLogin()</code>.</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$user_id</span>
                    : <span class="phpdocumentor-signature__argument__return-type">int</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$UserLoginsDb</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserLoginsDb">UserLoginsDb</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$UserFieldsDb</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserFieldsDb">UserFieldsDb</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">mixed</span>
            
</article>
                                    <a id="method_sessionTraitLogoutPreviousSessions"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--private
                                                        "
>
    <h4 class="phpdocumentor-method__name">sessionTraitLogoutPreviousSessions()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/Admin/Users/Sessions/Traits/SessionsTrait.php"><a href="../files/controllers-admin-users-sessions-traits-sessionstrait.html"><abbr title="Controllers/Admin/Users/Sessions/Traits/SessionsTrait.php">SessionsTrait.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">288</span>
    </aside>
        <p class="phpdocumentor-summary">Logout all sessions before latest succeeded login. (logout only succeeded login).</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">private</span>
                                <span class="phpdocumentor-signature__name">sessionTraitLogoutPreviousSessions</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$user_id</span> :
                <span class="phpdocumentor-signature__argument__return-type">int</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            ,                 <span class="phpdocumentor-signature__argument__name">$UserLoginsDb</span> :
                <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserLoginsDb">UserLoginsDb</abbr></span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">mixed</span>
    </code>

        <section class="phpdocumentor-description"><p>This method was called from <code class="prettyprint">isUserLoggedIn()</code>.</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$user_id</span>
                    : <span class="phpdocumentor-signature__argument__return-type">int</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$UserLoginsDb</span>
                    : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Rdb\Modules\RdbAdmin\Models\UserLoginsDb">UserLoginsDb</abbr></span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">mixed</span>
            
</article>
                                    <a id="method_addUpdateUserFormValidation"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">addUpdateUserFormValidation()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/Admin/Users/Traits/UsersTrait.php"><a href="../files/controllers-admin-users-traits-userstrait.html"><abbr title="Controllers/Admin/Users/Traits/UsersTrait.php">UsersTrait.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">38</span>
    </aside>
        <p class="phpdocumentor-summary">Form validation for add and update user.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">addUpdateUserFormValidation</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$data</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                            </span>
                    <span class="phpdocumentor-signature__argument">
            [,                 <span class="phpdocumentor-signature__argument__name">$dataField</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                 = <span class="phpdocumentor-signature__argument__default-value">[]</span> ]            </span>
                    <span class="phpdocumentor-signature__argument">
            [,                 <span class="phpdocumentor-signature__argument__name">$dataUsersRoles</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                 = <span class="phpdocumentor-signature__argument__default-value">[]</span> ]            </span>
                    <span class="phpdocumentor-signature__argument">
            [,                 <span class="phpdocumentor-signature__argument__name">$saveType</span> :
                <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;insert&#039;</span> ]            </span>
                    <span class="phpdocumentor-signature__argument">
            [,                 <span class="phpdocumentor-signature__argument__name">$user_id</span> :
                <span class="phpdocumentor-signature__argument__return-type">string|int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span> ]            </span>
                )
        : <span class="phpdocumentor-signature__response_type">array</span>
    </code>

        <section class="phpdocumentor-description"><p>Validate required and valid form fields.<br>
Validate that selected roles did not have higher priority that the user who add or update them.<br>
Validate username and email must not exists.<br>
This method was called from <code class="prettyprint">doAddAction()</code> method.</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$data</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The associative array form data.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$dataField</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                     = <span class="phpdocumentor-signature__argument__default-value">[]</span>                </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>Associative array for <code class="prettyprint">user_fields</code> table.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$dataUsersRoles</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                     = <span class="phpdocumentor-signature__argument__default-value">[]</span>                </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>Associative array for <code class="prettyprint">users_roles</code> table.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$saveType</span>
                    : <span class="phpdocumentor-signature__argument__return-type">string</span>
                     = <span class="phpdocumentor-signature__argument__default-value">&#039;insert&#039;</span>                </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>Type of saving data. It can be 'insert' or 'update'. Default is 'insert'.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$user_id</span>
                    : <span class="phpdocumentor-signature__argument__return-type">string|int</span>
                     = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>                </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The <code class="prettyprint">user_id</code> to check where <code class="prettyprint">$saveType</code> is 'update' that any user else data must be unique.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">array</span>
                    &mdash; <span class="phpdocumentor-description"><p>Return associative array with keys if contain at least one error:<br>
<code class="prettyprint">formResultStatus</code> (if error),<br>
<code class="prettyprint">formResultMessage</code> (if error) The result message,<br>
<code class="prettyprint">formFieldsValidation</code> (optional) Fields that contain errors,<br>
<code class="prettyprint">responseStatus</code> (optional) For HTTP response status,</p></span>
            
</article>
                                    <a id="method_decryptUserFieldsKey"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">decryptUserFieldsKey()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/Admin/Users/Traits/UsersTrait.php"><a href="../files/controllers-admin-users-traits-userstrait.html"><abbr title="Controllers/Admin/Users/Traits/UsersTrait.php">UsersTrait.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">230</span>
    </aside>
        <p class="phpdocumentor-summary">Decrypt user fields key.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">decryptUserFieldsKey</span>(
                    <span class="phpdocumentor-signature__argument">
                            <span class="phpdocumentor-signature__argument__name">$encryptedKey</span> :
                <span class="phpdocumentor-signature__argument__return-type">string|object</span>
                            </span>
                )
        : <span class="phpdocumentor-signature__response_type">string</span>
    </code>

    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$encryptedKey</span>
                    : <span class="phpdocumentor-signature__argument__return-type">string|object</span>
                                    </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The encrypted key string. Or you may set user_fields object from PDO query instead.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">string</span>
                    &mdash; <span class="phpdocumentor-description"><p>Return decrypted key string or return empty string if failed to decrypted.</p></span>
            
</article>
                                    <a id="method_generateUserFieldsKey"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">generateUserFieldsKey()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/Admin/Users/Traits/UsersTrait.php"><a href="../files/controllers-admin-users-traits-userstrait.html"><abbr title="Controllers/Admin/Users/Traits/UsersTrait.php">UsersTrait.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">277</span>
    </aside>
        <p class="phpdocumentor-summary">Generate user fields key.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">generateUserFieldsKey</span>(
                    <span class="phpdocumentor-signature__argument">
            [                <span class="phpdocumentor-signature__argument__name">$length</span> :
                <span class="phpdocumentor-signature__argument__return-type">int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">8</span> ]            </span>
                )
        : <span class="phpdocumentor-signature__response_type">array</span>
    </code>

        <section class="phpdocumentor-description"><p>Generate keys that can be use in change email confirmation, register confirmation, etc.</p></section>
    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$length</span>
                    : <span class="phpdocumentor-signature__argument__return-type">int</span>
                     = <span class="phpdocumentor-signature__argument__default-value">8</span>                </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The length of key.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">array</span>
                    &mdash; <span class="phpdocumentor-description"><p>Return associative array with 'readableKey', 'encryptedKey' keys.</p></span>
            
</article>
                                    <a id="method_getUserUrlsMethods"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">getUserUrlsMethods()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/Admin/Users/Traits/UsersTrait.php"><a href="../files/controllers-admin-users-traits-userstrait.html"><abbr title="Controllers/Admin/Users/Traits/UsersTrait.php">UsersTrait.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">309</span>
    </aside>
        <p class="phpdocumentor-summary">Get URLs and methods about user pages.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">getUserUrlsMethods</span>(
                    <span class="phpdocumentor-signature__argument">
            [                <span class="phpdocumentor-signature__argument__name">$user_id</span> :
                <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span> ]            </span>
                )
        : <span class="phpdocumentor-signature__response_type">array</span>
    </code>

    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$user_id</span>
                    : <span class="phpdocumentor-signature__argument__return-type">string</span>
                     = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>                </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The user ID.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">array</span>
                    &mdash; <span class="phpdocumentor-description"><p>Return associative array.</p></span>
            
</article>
                                    <a id="method_logoutUser"></a>
<article
        class="
            phpdocumentor-method
            phpdocumentor-method--protected
                                                        "
>
    <h4 class="phpdocumentor-method__name">logoutUser()</h4>
    <aside class="phpdocumentor-element-found-in">
        <abbr class="phpdocumentor-element-found-in__file" title="Controllers/Admin/Users/Traits/UsersTrait.php"><a href="../files/controllers-admin-users-traits-userstrait.html"><abbr title="Controllers/Admin/Users/Traits/UsersTrait.php">UsersTrait.php</abbr></a></abbr>
        :
        <span class="phpdocumentor-element-found-in__line">369</span>
    </aside>
        <p class="phpdocumentor-summary">Logout target user.</p>
        <code class="phpdocumentor-signature phpdocumentor-code ">
        <span class="phpdocumentor-signature__visibility">protected</span>
                                <span class="phpdocumentor-signature__name">logoutUser</span>(
                    <span class="phpdocumentor-signature__argument">
            [                <span class="phpdocumentor-signature__argument__name">$cookieData</span> :
                <span class="phpdocumentor-signature__argument__return-type">array</span>
                 = <span class="phpdocumentor-signature__argument__default-value">[]</span> ]            </span>
                    <span class="phpdocumentor-signature__argument">
            [,                 <span class="phpdocumentor-signature__argument__name">$logoutAllDevice</span> :
                <span class="phpdocumentor-signature__argument__return-type">bool</span>
                 = <span class="phpdocumentor-signature__argument__default-value">false</span> ]            </span>
                )
        : <span class="phpdocumentor-signature__response_type">mixed</span>
    </code>

    
            <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
        <dl class="phpdocumentor-argument-list">
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$cookieData</span>
                    : <span class="phpdocumentor-signature__argument__return-type">array</span>
                     = <span class="phpdocumentor-signature__argument__default-value">[]</span>                </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>The associative array of cookie data. This value can get from <code class="prettyprint">Cookie</code> class. The array keys are:<br>
<code class="prettyprint">user_id</code> (required).<br>
<code class="prettyprint">sessionKey</code> (optional) For delete specific session key from <code class="prettyprint">user_logins</code> table.</p></section></dd>
                            <dt class="phpdocumentor-argument-list__entry">
                    <span class="phpdocumentor-signature__argument__name">$logoutAllDevice</span>
                    : <span class="phpdocumentor-signature__argument__return-type">bool</span>
                     = <span class="phpdocumentor-signature__argument__default-value">false</span>                </dt>
                <dd class="phpdocumentor-argument-list__definition"><section class="phpdocumentor-description"><p>Set to <code class="prettyprint">true</code> to logout all device, <code class="prettyprint">false</code> for specific session key.</p></section></dd>
                    </dl>
    
        
            <h5 class="phpdocumentor-return-value__heading">Return values</h5>
        <span class="phpdocumentor-signature__response_type">mixed</span>
            
</article>
                            </section>
            </article>
            <div data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">

                <h2>Search results</h2>
                <ul class="phpdocumentor-search-results__entries">

                </ul>
            </div>
        </div>
    </div>
</main>

</body>
</html>
